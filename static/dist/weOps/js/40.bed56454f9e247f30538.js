(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{Wa1d:function(t,e,n){"use strict";n.r(e);var r,a=n("G0B5"),i=n("uMZD"),o=n("ac6i"),l=n("5Vuv"),s=n("JnIg"),c=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t,e,n,r){var a,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(o=(i<3?a(o):i>3?a(e,n,o):a(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o},p=function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{s(r.next(t))}catch(t){i(t)}}function l(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,l)}s((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.visible=!1,e.formData={label_name:""},e.rules={label_name:[{required:!0,message:"请输入标签名",trigger:"blur"}]},e.type="",e.row={},e.btnLoading=!1,e}return c(e,t),e.prototype.show=function(t,e){Object.assign(this.$data,this.$options.data.call(this)),this.type=t,this.row=e,"modifyLabel"===t&&(this.formData.label_name=e.label_name),this.visible=!0},e.prototype.close=function(){this.visible=!1},e.prototype.confirm=function(){var t=this;this.$refs.validateForm.validate().then((function(e){t.createOrEditLabel()}))},e.prototype.createOrEditLabel=function(){return p(this,void 0,void 0,(function(){var t,e;return f(this,(function(n){switch(n.label){case 0:(t={id:this.row.id}).label_name=this.formData.label_name,this.btnLoading=!0,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.$api.lore[this.type](t)];case 2:return(e=n.sent()).result?(this.$message.success("操作成功"),this.visible=!1,this.$emit("updateData"),[3,4]):(this.$message.error(e.message),[2]);case 3:return this.btnLoading=!1,[7];case 4:return[2]}}))}))},e=u([Object(a.a)({components:{}})],e)}(a.e),b=h,d=n("KHd+"),m=Object(d.a)(b,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("bk-dialog",{attrs:{"render-directive":"if","mask-close":!1,"header-position":"left",width:"500px",title:"addLabel"===t.type?"新建标签":"编辑标签"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("div",[n("bk-form",{ref:"validateForm",attrs:{"label-width":100,model:t.formData,rules:t.rules}},[n("bk-form-item",{attrs:{label:"标签名称：",required:!0,property:"label_name"}},[n("bk-input",{attrs:{placeholder:"请输入标签名称"},model:{value:t.formData.label_name,callback:function(e){t.$set(t.formData,"label_name",e)},expression:"formData.label_name"}})],1)],1)],1),t._v(" "),n("div",{staticStyle:{width:"100%"},attrs:{slot:"footer"},slot:"footer"},[n("div",[n("bk-button",{staticClass:"mr20",attrs:{theme:"primary",loading:t.btnLoading},on:{click:t.confirm}},[t._v("\n                    确定\n                ")]),t._v(" "),n("bk-button",{attrs:{theme:"default"},on:{click:t.close}},[t._v("\n                    取消\n                ")])],1)])])],1)}),[],!1,null,null,null).exports,v=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t,e,n,r){var a,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(o=(i<3?a(o):i>3?a(e,n,o):a(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o},g=function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{s(r.next(t))}catch(t){i(t)}}function l(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,l)}s((r=r.apply(t,e||[])).next())}))},w=function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.search="",e.tableLoading=!1,e.dataList=[],e.columns=[{label:"标签名称",key:"label_name",minWidth:"200px"},{label:"使用文章数",key:"use_count",minWidth:"100px"},{label:"操作",key:"operation",width:"200px",prop:"operation",scopedSlots:"operation"}],e.pagination={current:1,count:0,limit:20},e}return v(e,t),e.prototype.mounted=function(){this.getTagList()},e.prototype.getTagList=function(){return g(this,void 0,void 0,(function(){var t,e;return w(this,(function(n){switch(n.label){case 0:t=this.getParams(),this.tableLoading=!0,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.$api.lore.getRepositoryLabels(t)];case 2:return(e=n.sent()).result?(this.dataList=e.data.items,this.pagination.count=e.data.count,[3,4]):(this.$error(e.message),[2]);case 3:return this.tableLoading=!1,[7];case 4:return[2]}}))}))},e.prototype.getParams=function(){var t=this.pagination;return{page_size:t.limit,page:t.current,search:this.search,search_type:"all"}},e.prototype.tagOperation=function(t,e){void 0===e&&(e={}),this.btnForbidden||this.$refs.tagDialog.show(t,e)},e.prototype.handleDelete=function(t){return g(this,void 0,void 0,(function(){var e=this;return w(this,(function(n){return this.btnForbidden||this.$bkInfo({title:"提示",subTitle:"确定删除该标签吗？",theme:"primary",confirmFn:function(){e.confirmDelete(t.id)}}),[2]}))}))},e.prototype.confirmDelete=function(t){return g(this,void 0,void 0,(function(){var e;return w(this,(function(n){switch(n.label){case 0:return this.tableLoading=!0,[4,this.$api.lore.deleteLabel({id:t})];case 1:return(e=n.sent()).result?(this.$success("删除成功"),this.pagination.current>1&&1===this.dataList.length&&this.pagination.current--,this.getTagList(),[2]):(this.$error(e.message),this.tableLoading=!1,[2])}}))}))},e.prototype.handlePageChange=function(t){this.pagination.current=t,this.getTagList()},e.prototype.limitChange=function(t){this.pagination.current=1,this.pagination.limit=t,this.getTagList()},e=y([Object(a.a)({components:{ComTable:s.a,TagDialog:m}})],e)}(l.a),O=_,k=Object(d.a)(O,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-tag"},[n("div",{staticClass:"nav-area"},[n("bk-input",{staticClass:"nav-area-search",staticStyle:{width:"200px"},attrs:{placeholder:"请输入标签名称",clearable:""},on:{enter:t.getTagList},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),n("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:t.permissionObj,expression:"permissionObj"}],attrs:{theme:"primary"},on:{click:function(e){return t.tagOperation("addLabel")}}},[t._v("\n            新建标签\n        ")])],1),t._v(" "),n("div",{staticClass:"table-area"},[n("ComTable",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"healthTable",staticClass:"common-table-max-height-tab",attrs:{data:t.dataList,columns:t.columns,pagination:t.pagination},on:{"page-change":t.handlePageChange,"page-limit-change":t.limitChange},scopedSlots:t._u([{key:"operation",fn:function(e){var r=e.row;return[n("div",[n("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:t.permissionObj,expression:"permissionObj"}],staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(e){return t.tagOperation("modifyLabel",r)}}},[t._v("\n                        修改\n                    ")]),t._v(" "),n("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:t.permissionObj,expression:"permissionObj"}],staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(e){return t.handleDelete(r)}}},[t._v("\n                        删除\n                    ")])],1)]}}])})],1),t._v(" "),n("TagDialog",{ref:"tagDialog",on:{updateData:t.getTagList}})],1)}),[],!1,null,"ac944682",null).exports,x=n("KJcb"),L=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t,e,n,r){var a,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(o=(i<3?a(o):i>3?a(e,n,o):a(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o},j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.panels=[{name:"articleTag",label:"文章标签"},{name:"articleTemplate",label:"文章模板"}],e.active="articleTag",e}return L(e,t),e.prototype.mounted=function(){window.articleTab&&(this.active="articleTemplate")},e.prototype.toTabMenu=function(t){this.active=t.name},e=T([Object(a.a)({components:{MenuTab:o.a,ArticleTag:k,ArticleTemplate:x.a,HeaderSub:i.a},beforeRouteEnter:function(t,e,n){"ArticleTemplate"===e.name&&(window.articleTab="articleTemplate"),n()},beforeRouteLeave:function(t,e,n){window.articleTab="",this.$handleKeepAlive(t,e),n()}})],e)}(a.e),D=j,$=Object(d.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("HeaderSub",{staticClass:"notice-manage-header"},[n("template",{slot:"title"},[n("MenuTab",{attrs:{panels:t.panels,type:"line","active-panel":t.active},on:{click:t.toTabMenu}})],1)],2),t._v(" "),n(t.active,{tag:"component",staticStyle:{height:"100%"}})],1)}),[],!1,null,null,null);e.default=$.exports}}]);