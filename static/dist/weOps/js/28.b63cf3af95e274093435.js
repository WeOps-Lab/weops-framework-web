(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{ZwOy:function(e,t,r){"use strict";r.r(t);var n,a=r("G0B5"),i=r("JnIg"),o=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isShow=!1,t.formData={type:"",brandName:"",templateName:""},t.rules={templateName:[{required:!0,message:"必填项",trigger:"blur"}],brandName:[{required:!0,message:"必填项",trigger:"blur"}],type:[{required:!0,message:"必填项",trigger:"blur"}]},t.iconUrl="cc-default",t.loading=!1,t.currentType="add",t.templateDetail="",t.brandList=[{text:"思科",value:"cisco"},{text:"华为",value:"huawei"},{text:"华三",value:"h3c"}],t.deviceTypeList=[{text:"交换机",value:"switch"},{text:"路由器",value:"router"},{text:"防火墙",value:"firewall"},{text:"负载均衡",value:"loadbalancer"}],t.formDataV2={},t}return o(t,e),Object.defineProperty(t.prototype,"isAdd",{get:function(){return"add"===this.currentType},enumerable:!1,configurable:!0}),t.prototype.show=function(e,t){this.currentType=e,this.isShow=!0,"edit"===e?(this.templateDetail=t,this.formData={type:t.device_type,brandName:t.brand,templateName:t.template_name}):this.initData(),this.formDataV2=JSON.parse(JSON.stringify(this.formData))},t.prototype.confirm=function(){var e=this;this.$refs.validateForm.validate().then((function(t){var r={template_name:e.formData.templateName,device_type:e.formData.type,brand:e.formData.brandName};e.operateTemplate(e.isAdd?r:{id:e.templateDetail.id,body:r})}))},t.prototype.operateTemplate=function(e){var t=this;this.loading=!0,this.$api.autoManage[this.isAdd?"createNetWorkToolTemplate":"modifyNetWorkToolTemplate"](e).then((function(e){if(!e.result)return t.$error(e.message),!1;t.$success("".concat(t.isAdd?"新增":"编辑","模板成功!")),t.isShow=!1,t.$emit("refreshList")})).finally((function(){t.loading=!1}))},t.prototype.cancel=function(){var e=this;this.$compareFormData(this.formData,this.formDataV2)?this.isShow=!1:this.$bkInfo({title:"是否放弃本次操作？",subTitle:"放弃将导致未保存信息丢失",theme:"primary",confirmFn:function(){e.isShow=!1}})},t.prototype.initData=function(){this.templateDetail="",this.formData={type:"",brandName:"",templateName:""}},t=l([a.a],t)}(a.e),c=s,u=r("KHd+"),p=Object(u.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("bk-sideslider",{attrs:{width:500,"is-show":e.isShow,"before-close":e.cancel,"quick-close":!1},on:{"update:isShow":function(t){e.isShow=t},"update:is-show":function(t){e.isShow=t}}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v(e._s((e.isAdd?"新建":"编辑")+"模板"))]),e._v(" "),r("div",{staticClass:"content-box",attrs:{slot:"content"},slot:"content"},[r("bk-form",{ref:"validateForm",staticStyle:{flex:"1"},attrs:{"label-width":110,model:e.formData,rules:e.rules,"form-type":"vertical"}},[r("bk-form-item",{attrs:{label:"模板名称",required:!0,property:"templateName","desc-type":"icon","error-display-type":"normal"}},[r("bk-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.formData.templateName,callback:function(t){e.$set(e.formData,"templateName",t)},expression:"formData.templateName"}})],1),e._v(" "),r("bk-form-item",{attrs:{label:"设备类型",required:!0,property:"type","error-display-type":"normal"}},[r("bk-select",{attrs:{placeholder:"请选择设备类型"},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.deviceTypeList,(function(e){return r("bk-option",{key:e.value,attrs:{id:e.value,name:e.text}})})),1)],1),e._v(" "),r("bk-form-item",{attrs:{label:"品牌名称",required:!0,"desc-type":"icon",property:"brandName","error-display-type":"normal"}},[r("bk-select",{attrs:{placeholder:"请选择品牌名称"},model:{value:e.formData.brandName,callback:function(t){e.$set(e.formData,"brandName",t)},expression:"formData.brandName"}},e._l(e.brandList,(function(e){return r("bk-option",{key:e.value,attrs:{id:e.value,name:e.text}})})),1)],1)],1),e._v(" "),r("div",{staticClass:"foot-box"},[r("bk-button",{attrs:{theme:"default",type:"submit"},on:{click:e.cancel}},[e._v("\n                取消\n            ")]),e._v(" "),r("bk-button",{staticClass:"mr10",attrs:{loading:e.loading,disabled:e.loading,theme:"primary"},on:{click:e.confirm}},[e._v("\n                确认\n            ")])],1)],1)])}),[],!1,null,"3437dfe8",null).exports,f=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=function(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="",t.isShow=!1,t.formData={model:"",rule:""},t.rules={model:[{required:!0,message:"必填项",trigger:"blur"}],rule:[{required:!0,message:"必填项",trigger:"blur"}]},t.templateMarchDetail={},t.loading=!1,t.formDataV2={},t}return f(t,e),Object.defineProperty(t.prototype,"isAdd",{get:function(){return"add"===this.type},enumerable:!1,configurable:!0}),t.prototype.show=function(e,t){this.isShow=!0,this.type=e,"edit"===e?(this.templateMarchDetail=t,this.formData={rule:t.end_matching,model:t.device_model}):this.formData={rule:"",model:""},this.formDataV2=JSON.parse(JSON.stringify(this.formData))},t.prototype.confirm=function(){var e=this;this.$refs.validateForm.validate().then((function(t){var r={end_matching:e.formData.rule,device_model:e.formData.model,network_tool_template:e.templateDetail.id};e.operateConRemark(e.isAdd?r:{id:e.templateMarchDetail.id,body:r})}))},t.prototype.operateConRemark=function(e){var t=this;this.loading=!0,this.$api.autoManage[this.isAdd?"createTemplateMarch":"modifyTemplateMarch"](e).then((function(e){if(!e.result)return t.$error(e.message),!1;t.$success("".concat(t.isAdd?"新增":"编辑","结束语成功!")),t.isShow=!1,t.$emit("refreshList",t.type)})).finally((function(){t.loading=!1}))},t.prototype.cancel=function(){var e=this;this.$compareFormData(this.formData,this.formDataV2)?this.isShow=!1:this.$bkInfo({title:"是否放弃本次操作？",subTitle:"放弃将导致未保存信息丢失",theme:"primary",confirmFn:function(){e.isShow=!1}})},d([Object(a.d)({type:Object,default:function(){}})],t.prototype,"templateDetail",void 0),t=d([Object(a.a)({name:"operateConRemark"})],t)}(a.e),m=h,b=Object(u.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("bk-sideslider",{attrs:{width:500,"is-show":e.isShow,"before-close":e.cancel,"quick-close":!1},on:{"update:isShow":function(t){e.isShow=t},"update:is-show":function(t){e.isShow=t}}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v(e._s((e.isAdd?"新建":"编辑")+"结束语"))]),e._v(" "),r("div",{staticClass:"content-box",attrs:{slot:"content"},slot:"content"},[r("bk-form",{ref:"validateForm",staticStyle:{flex:"1","padding-bottom":"20px"},attrs:{"label-width":105,model:e.formData,rules:e.rules}},[r("bk-form-item",{attrs:{label:"型号",required:"",property:"model"}},[r("bk-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入设备型号：\n1、输入“*”则表示默认型号，当未匹配到具体型号时，会使用默认型号规则\n2、多个型号用“,”分隔，例如：BS2080,BS5800"},model:{value:e.formData.model,callback:function(t){e.$set(e.formData,"model",t)},expression:"formData.model"}})],1),e._v(" "),r("bk-form-item",{attrs:{label:"结束语规则",required:"",property:"rule"}},[r("bk-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入结束语规则的正则表达式，系统匹配到该规则时判断当前命令已执行结束，将执行下一条命令或结束执行，内容必须包含${device_name}。"},model:{value:e.formData.rule,callback:function(t){e.$set(e.formData,"rule",t)},expression:"formData.rule"}})],1)],1),e._v(" "),r("div",{staticClass:"foot-box"},[r("bk-button",{attrs:{theme:"default",type:"submit"},on:{click:e.cancel}},[e._v("\n                取消\n            ")]),e._v(" "),r("bk-button",{staticClass:"mr10",attrs:{loading:e.loading,disabled:e.loading,theme:"primary"},on:{click:e.confirm}},[e._v("\n                确认\n            ")])],1)],1)])}),[],!1,null,"6b909cda",null).exports,y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),v=function(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},g=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,l)}s((n=n.apply(e,t||[])).next())}))},w=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tableLoading=!1,t.dataList=[],t.columns=[{label:"型号",key:"device_model",align:"left",minWidth:"200px",scopedSlots:"device_model"},{label:"结束语规则",key:"end_matching",align:"left",minWidth:"200px"},{label:"操作",key:"operation",align:"left",width:"120px",scopedSlots:"operation"}],t.maxHeight="",t.pagination={current:1,count:1,limit:20},t.isShow=!1,t.searchValue="",t.currentSearchType="device_model",t.filterList=[{id:"device_model",name:"型号"}],t.templateDetail={},t}return y(t,e),Object.defineProperty(t.prototype,"powerParams",{get:function(){return{id:this.$route.name,type:"operateAuth"}},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){var e=this;this.maxHeight=window.innerHeight-152,window.onresize=function(){e.maxHeight=window.innerHeight-152}},t.prototype.show=function(e){this.isShow=!0,this.templateDetail=e,this.getTemplateMarch()},t.prototype.deleteList=function(e){var t=this;if(!this.$BtnPermission(this.powerParams))return!1;this.$bkInfo({title:"确认要删除该结束语？",confirmLoading:!0,confirmFn:function(){return g(t,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.confirmDelete(e)];case 1:return t.sent(),[2]}}))}))}})},t.prototype.confirmDelete=function(e){return g(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.$api.autoManage.delTemplateMarch({id:e.id})];case 1:return(t=r.sent()).result?(this.$success("删除成功!"),this.pagination.current>1&&1===this.dataList.length&&this.pagination.current--,this.getTemplateMarch(),this.$emit("refreshList")):this.$error(t.message),[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}}))}))},t.prototype.operateList=function(e,t){if(!this.$BtnPermission(this.powerParams))return!1;this.$refs.operateConRemarks.show(e,t)},t.prototype.getTemplateMarch=function(e){var t=this;"add"===e&&this.$emit("refreshList");var r={search:this.searchValue,page_size:this.pagination.limit,page:this.pagination.current,template_id:this.templateDetail.id};this.tableLoading=!0,this.$api.autoManage.getTemplateMarch(r).then((function(e){var r=e.result,n=e.data;if(!r)return!1;t.dataList=n.items,t.pagination.count=n.count})).finally((function(){t.tableLoading=!1}))},t.prototype.handlerIconClick=function(){this.pagination.current=1,this.getTemplateMarch()},t.prototype.handlePageChange=function(e){this.pagination.current=e,this.getTemplateMarch()},t.prototype.limitChange=function(e){this.pagination.limit=e,this.pagination.current=1,this.getTemplateMarch()},t=v([Object(a.a)({components:{ComTable:i.a,operateConRemarks:b}})],t)}(a.e),_=k,x=Object(u.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("bk-sideslider",{attrs:{width:700,title:"结束语","is-show":e.isShow,"quick-close":!0},on:{"update:isShow":function(t){e.isShow=t},"update:is-show":function(t){e.isShow=t}}},[r("div",{staticClass:"content-box",attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"action-bar"},[r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],attrs:{theme:"primary",title:"添加",disabled:e.templateDetail.built_in},on:{click:function(t){return e.operateList("add")}}},[e._v("\n                    添加\n                ")]),e._v(" "),r("div",{staticClass:"search-box"},[r("bk-input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入搜索型号",clearable:!0,"right-icon":"bk-icon icon-search"},on:{"right-icon-click":e.handlerIconClick,enter:e.handlerIconClick,clear:e.handlerIconClick},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)],1),e._v(" "),r("com-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"sourceTable",staticClass:"com-table",attrs:{id:"center_table",data:e.dataList,columns:e.columns,"max-height":e.maxHeight,pagination:e.pagination},on:{"page-change":e.handlePageChange,"page-limit-change":e.limitChange},scopedSlots:e._u([{key:"device_model",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(n.device_model.join(",")||"--"))])]}},{key:"operation",fn:function(t){var n=t.row;return[r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:e.templateDetail.built_in},on:{click:function(t){return e.operateList("edit",n)}}},[e._v("\n                        修改\n                    ")]),e._v(" "),r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:e.templateDetail.built_in},on:{click:function(t){return e.deleteList(n)}}},[e._v("\n                        删除\n                    ")])]}}])})],1)]),e._v(" "),r("operate-con-remarks",{ref:"operateConRemarks",attrs:{"template-detail":e.templateDetail},on:{refreshList:e.getTemplateMarch}})],1)}),[],!1,null,"01183fe7",null).exports,T=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),D=function(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},C=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,l)}s((n=n.apply(e,t||[])).next())}))},O=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.search="",t.tableLoading=!1,t.dataList=[],t.columns=[{label:"模板名称",key:"template_name",align:"left",minWidth:"150px"},{label:"设备类型",key:"device_type",align:"left",minWidth:"80px",filterable:!0,filterMultiple:!1,filterRemote:!0,filters:[{text:"交换机",value:"switch"},{text:"路由器",value:"router"},{text:"防火墙",value:"firewall"},{text:"负载均衡",value:"loadbalancer"}],scopedSlots:"device_type"},{label:"品牌",key:"brand",align:"left",minWidth:"100px",filterable:!0,filterMultiple:!1,filterRemote:!0,filters:[{text:"Cisco",value:"cisco"},{text:"华为",value:"huawei"},{text:"H3C",value:"h3c"}],scopedSlots:"brand"},{label:"结束语规则数",key:"end_match_count",align:"left",minWidth:"150px",sortable:!0},{label:"是否内置",key:"built_in",align:"left",minWidth:"100px",scopedSlots:"built_in"},{label:"操作",key:"operation",fixed:"right",align:"left",width:"180px",scopedSlots:"operation"}],t.deviceTypeMap={switch:"交换机",router:"路由器",firewall:"防火墙",loadbalancer:"负载均衡"},t.pagination={current:1,count:1,limit:20},t.brandMap={cisco:"Cisco",huawei:"华为",h3c:"H3C"},t.brand="",t.deviceType="",t.maxHeight="",t}return T(t,e),Object.defineProperty(t.prototype,"powerParams",{get:function(){return{id:this.$route.name,type:"operateAuth"}},enumerable:!1,configurable:!0}),t.prototype.created=function(){var e=this;this.maxHeight=window.innerHeight-184,window.onresize=function(){e.maxHeight=window.innerHeight-184},this.getNetWorkToolTemplate()},t.prototype.handlerIconClick=function(){this.pagination.current=1,this.getNetWorkToolTemplate()},t.prototype.getNetWorkToolTemplate=function(){var e=this,t={search:this.search,brand:this.brand,device_type:this.deviceType,page_size:this.pagination.limit,page:this.pagination.current};this.tableLoading=!0,this.$api.autoManage.getNetWorkToolTemplate(t).then((function(t){var r=t.result,n=t.data;if(!r)return!1;e.dataList=n.items,e.pagination.count=n.count})).finally((function(){e.tableLoading=!1}))},t.prototype.deleteTemplate=function(e){var t=this;if(!this.$BtnPermission(this.powerParams))return!1;this.$bkInfo({title:"确认要删除该模板？",confirmLoading:!0,confirmFn:function(){return C(t,void 0,void 0,(function(){return O(this,(function(t){switch(t.label){case 0:return[4,this.confirmDelete(e)];case 1:return t.sent(),[2]}}))}))}})},t.prototype.confirmDelete=function(e){return C(this,void 0,void 0,(function(){var t;return O(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.$api.autoManage.delNetWorkToolTemplate({id:e.id})];case 1:return(t=r.sent()).result?(this.$success("删除成功!"),this.pagination.current>1&&1===this.dataList.length&&this.pagination.current--,this.getNetWorkToolTemplate()):this.$error(t.message),[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}}))}))},t.prototype.operateTemplate=function(e,t){if(!this.$BtnPermission(this.powerParams))return!1;this.$refs.operateTemplate.show(e,t)},t.prototype.checkConcludingRemarks=function(e){this.$refs.concludingRemarks.show(e)},t.prototype.filterChange=function(e){for(var t in e)"device_type"===t&&(this.deviceType=e[t][0]),"brand"===t&&(this.brand=e[t][0]);this.getNetWorkToolTemplate()},t.prototype.handlePageChange=function(e){this.pagination.current=e,this.getNetWorkToolTemplate()},t.prototype.limitChange=function(e){this.pagination.limit=e,this.pagination.current=1,this.getNetWorkToolTemplate()},t=D([Object(a.a)({components:{comTable:i.a,OperateTemplate:p,ConcludingRemarks:x}})],t)}(a.e),P=S,$=Object(u.a)(P,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"network-device"},[r("div",{staticClass:"action-bar"},[r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],staticClass:"mr20",attrs:{theme:"primary"},on:{click:function(t){return e.operateTemplate("add")}}},[e._v("\n            新建模板\n        ")]),e._v(" "),r("bk-input",{staticStyle:{flex:"1"},attrs:{clearable:"",placeholder:"请输入搜索关键字","right-icon":"bk-icon icon-search"},on:{"right-icon-click":e.handlerIconClick,enter:e.handlerIconClick,clear:e.handlerIconClick},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),r("div",{staticClass:"table-box"},[r("com-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.tableLoading,zIndex:10},expression:"{ isLoading: tableLoading, zIndex: 10 }"}],ref:"comTable",attrs:{data:e.dataList,columns:e.columns,"max-height":e.maxHeight,pagination:e.pagination},on:{"page-change":e.handlePageChange,"page-limit-change":e.limitChange,"filter-change":e.filterChange},scopedSlots:e._u([{key:"brand",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(e.brandMap[n.brand]))])]}},{key:"device_type",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(e.deviceTypeMap[n.device_type]))])]}},{key:"built_in",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(n.built_in?"是":"否"))])]}},{key:"operation",fn:function(t){var n=t.row;return[r("bk-button",{staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(t){return e.checkConcludingRemarks(n)}}},[e._v("\n                    结束语\n                ")]),e._v(" "),r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:n.built_in},on:{click:function(t){return e.operateTemplate("edit",n)}}},[e._v("\n                    修改\n                ")]),e._v(" "),r("bk-button",{directives:[{name:"permission",rawName:"v-permission",value:e.powerParams,expression:"powerParams"}],staticClass:"mr10",attrs:{theme:"primary",text:"",disabled:n.built_in},on:{click:function(t){return e.deleteTemplate(n)}}},[e._v("\n                    删除\n                ")])]}}])})],1),e._v(" "),r("operate-template",{ref:"operateTemplate",on:{refreshList:e.getNetWorkToolTemplate}}),e._v(" "),r("concluding-remarks",{ref:"concludingRemarks",on:{refreshList:e.getNetWorkToolTemplate}})],1)}),[],!1,null,"18548979",null);t.default=$.exports}}]);